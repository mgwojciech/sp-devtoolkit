(this["webpackJsonpsp-devtoolkit"]=this["webpackJsonpsp-devtoolkit"]||[]).push([[0],{69:function(e,t,n){e.exports=n(78)},74:function(e,t,n){},75:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(19),s=n.n(i),r=(n(74),n(75),n(48)),l=n(31),c=n(32),u=n(61),d=n(49),p=n(17),h=n(59),b=n(108),f=n(106),m=n(111);n(76);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=function(e){function t(e,n){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={Response:"",WebUrl:"",EndpointUrl:"/_api/web",Method:"GET",Digests:[]},a.UpdateWebUrl=a.UpdateWebUrl.bind(Object(p.a)(a)),a.HandleClick=a.HandleClick.bind(Object(p.a)(a)),a.UpdateEndpointUrl=a.UpdateEndpointUrl.bind(Object(p.a)(a)),a.UpdateRequestBody=a.UpdateRequestBody.bind(Object(p.a)(a)),a.UpdateMethod=a.UpdateMethod.bind(Object(p.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"GetFormDigest",value:function(){var e=this,t=e.state.WebUrl+"/_api/contextinfo",n=e.state.Digests.filter((function(t){return t.Site===e.state.WebUrl}))[0];return n?new Promise((function(e){e(n.Digest)})):e.props.WebClient.CallWebService(t,{method:"POST",headers:{accept:"application/json"}}).then((function(t){return e.state.Digests.push({Site:e.state.WebUrl,Digest:t.FormDigestValue}),e.forceUpdate(),t.FormDigestValue}))}},{key:"HandleClick",value:function(){var e=(this.state.WebUrl||"")+this.state.EndpointUrl,t=this;"GET"!=t.state.Method?t.GetFormDigest().then((function(n){t.props.WebClient.CallWebService(e,{headers:{accept:"application/json","X-RequestDigest":n,"Content-Type":"application/json","IF-MATCH":"*","X-HTTP-Method":t.state.Method},method:"POST",body:t.state.RequestBody?JSON.stringify(JSON.parse(t.state.RequestBody)):null}).then((function(e){t.setState(v({},t.state,{Response:JSON.stringify(e,null,4)}))}))})):t.props.WebClient.CallWebService(e,{headers:{accept:"application/json"},method:t.state.Method}).then((function(e){t.setState(v({},t.state,{Response:JSON.stringify(e,null,4)}))}))}},{key:"UpdateWebUrl",value:function(e,t){t&&this.setState(v({},this.state,{WebUrl:t}))}},{key:"UpdateEndpointUrl",value:function(e,t){t&&this.setState(v({},this.state,{EndpointUrl:t}))}},{key:"UpdateRequestBody",value:function(e,t){t&&this.setState(v({},this.state,{RequestBody:t}))}},{key:"UpdateMethod",value:function(e,t,n){t&&this.setState(v({},this.state,{Method:t.text}))}},{key:"render",value:function(){var e=this.state.Method;return o.a.createElement("div",null,o.a.createElement(b.a,{label:"Web relative url",onChange:this.UpdateWebUrl,value:this.state.WebUrl}),o.a.createElement(b.a,{label:"API Endpoint",onChange:this.UpdateEndpointUrl,value:this.state.EndpointUrl}),o.a.createElement(f.a,{label:"Select HTTP Method",placeholder:"Select method",selectedKey:e||"GET",onChange:this.UpdateMethod,options:[{key:"GET",text:"GET"},{key:"POST",text:"POST"},{key:"PATCH",text:"PATCH"},{key:"MERGE",text:"MERGE"},{key:"DELETE",text:"DELETE"}],styles:{dropdown:{width:300}}}),o.a.createElement(b.a,{label:"Body",multiline:!0,autoAdjustHeight:!0,onChange:this.UpdateRequestBody}),o.a.createElement(m.a,{text:"Send Query",onClick:this.HandleClick,allowDisabledFocus:!0}),o.a.createElement(b.a,{label:"Response",multiline:!0,autoAdjustHeight:!0,value:this.state.Response||""}))}}]),t}(a.Component),O=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,[{key:"CallWebService",value:function(e,t){t.headers=t.headers||{},t.headers.accept=t.headers.accept||"application/json";var n=JSON.stringify(t);return new Promise((function(t,a){chrome.tabs.getSelected(null,(function(a){chrome.tabs.executeScript(a.id,{code:'fetch("'+e+'", '+n+").then((result)=>{ return result.json().then(responseText=>{chrome.runtime.sendMessage(responseText)})})"},(function(){new Promise((function(e){chrome.runtime.onMessage.addListener((function t(n){chrome.runtime.onMessage.removeListener(t),e(n)}))})).then((function(e){t(e)}))}))}))}))}}]),e}(),U=function(){var e=new O;return o.a.createElement("div",{className:"App"},o.a.createElement(E,{WebClient:e}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[69,1,2]]]);
//# sourceMappingURL=main.176be315.chunk.js.map